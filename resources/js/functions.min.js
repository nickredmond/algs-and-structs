/**
	Various sorting algorithms for lists of non-negative integers
*/
var merge_sort = function(list, step_callback) {

};

/** O(n^2) */
var bubble_sort = function(list, step_callback) {
	var sortedList = list;
	var isSorted = false;

	for (var i = 0; i < list.length && !isSorted; i++) {
		var unsortedLength = list.length - i;
		isSorted = true;

		for (var j = 0; j < unsortedLength - 1; j++) {
			var left = sortedList[j];
			var right = sortedList[j + 1];
			if (left > right) {
				isSorted = false;
				sortedList[j + 1] = left;
				sortedList[j] = right;
			}
			step_callback({ "sorted_list": sortedList });
		}
	}

	return sortedList;
};
var insertion_sort = function(list, step_callback) {

};
var selection_sort = function(list, step_callback) {
	var sortedList = list;

	for (var i = 0; i < sortedList.length - 1; i++) {
		var smallestIndex = i;
		for (var j = i + 1; j < sortedList.length; j++) {
			if (sortedList[j] < sortedList[smallestIndex]) {
				smallestIndex = j;
			}
		}

		var smallestValue = sortedList[smallestIndex];
		sortedList[smallestIndex] = sortedList[i];
		sortedList[i] = smallestValue;
		step_callback({ "sorted_list": sortedList });
	}

	return sortedList;
};

/** O(n) */
var bucket_sort = function(list, step_callback) {
	var maxValue = 0;
	for (var i = 0; i < list.length; i++) {
		maxValue = Math.max(maxValue, list[i]);
	}
	step_callback({ "max_value": maxValue });

	var buckets = Array(maxValue + 1).fill(0);
	for (var i = 0; i < list.length; i++) {
		var bucketIndex = list[i];
		buckets[bucketIndex] += 1;
	}
	step_callback({ "buckets": buckets })

	var sortedList = [];
	for (var i = 0; i < buckets.length; i++) {
		var bucketCount = buckets[i];
		for (var j = 0; j < bucketCount; j++) {
			sortedList.push(i);
			step_callback({ "sorted_list": sortedList });
		}
	}

	return sortedList;
};

var sortList = function(list, algorithm, algorithmName) {
	console.log("--- " + algorithmName.toUpperCase() + " ---");
	console.log("LIST: " + JSON.stringify(list));
	var result = algorithm(list, function(data) {
		console.log(JSON.stringify(data));
	});
	console.log("RESULT: " + JSON.stringify(result) + "\n");
};

var list = [3, 2, 5, 0, 1, 9, 1, 8, 8, 8, 7];
sortList(list, bucket_sort, "bucket sort");
sortList(list, bubble_sort, "bubble sort");

list = [3, 2, 5, 0, 1, 9, 1, 8, 8, 8, 7];
sortList(list, selection_sort, "selection sort");